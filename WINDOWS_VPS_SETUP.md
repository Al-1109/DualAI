# Инструкция по установке DualAI бота на Windows VPS

## Предварительные требования
- Windows VPS (Windows Server 2016/2019/2022 или Windows 10/11)
- Python 3.8 или выше
- Права администратора

## Подготовка VPS

1. **Установите Python**: 
   - Скачайте и установите [Python](https://www.python.org/downloads/) (отметьте галочку "Add Python to PATH" при установке)
   - Проверьте установку, открыв командную строку и введя: `python --version`

2. **Настройте брандмауэр Windows**:
   - Убедитесь, что исходящие соединения на порт 443 разрешены (для доступа к Telegram API)

## Установка и запуск бота

### Вариант 1: Ручной запуск

1. **Клонирование репозитория**:
   ```batch
   git clone https://github.com/Al-1109/DualAI.git
   cd DualAI
   ```

2. **Запуск бота**:
   - Запустите файл `setup_and_run_bot.bat`, дважды кликнув на него
   - Скрипт автоматически:
     - Создаст виртуальное окружение Python
     - Установит необходимые зависимости
     - Запустит бота с системой мониторинга

3. **Остановка бота**:
   - Нажмите `Ctrl+C` в консоли, где работает бот
   - Подтвердите остановку, нажав `Y` и `Enter`

### Вариант 2: Установка как службы Windows (рекомендуется)

1. **Клонирование репозитория**:
   ```batch
   git clone https://github.com/Al-1109/DualAI.git
   cd DualAI
   ```

2. **Установка службы**:
   - Кликните правой кнопкой мыши на `install_as_service.bat` и выберите "Запуск от имени администратора"
   - Скрипт автоматически:
     - Загрузит и установит NSSM (Non-Sucking Service Manager)
     - Создаст и настроит Windows-службу для бота
     - Запустит службу

3. **Управление службой**:
   - **Запуск**: `sc start DualAIBot`
   - **Остановка**: `sc stop DualAIBot`
   - **Проверка статуса**: `sc query DualAIBot`
   - **Удаление службы**: `sc delete DualAIBot` (требует прав администратора)

## Конфигурация бота

### Настройка токена Telegram-бота

1. **Через переменные окружения**:
   - Скрипт автоматически создаст файл `.env` с токеном по умолчанию
   - Отредактируйте файл `.env` для изменения токена

2. **Через системные переменные Windows**:
   - Откройте "Система" -> "Дополнительные параметры системы" -> "Переменные среды"
   - Добавьте новую переменную `TEST_TELEGRAM_BOT_TOKEN` с вашим токеном

## Мониторинг и логи

### Просмотр логов

Логи сохраняются в папке `logs`:
- `bot_log_*.txt` - логи самого бота
- `runner_log_*.txt` - логи системы мониторинга
- `service_stdout.log`/`service_stderr.log` - логи службы (если установлена)

### Мониторинг работы

1. **При ручном запуске**:
   - Статус отображается прямо в консоли

2. **При работе как службы**:
   - Используйте "Диспетчер служб Windows" (`services.msc`)
   - Проверяйте логи в папке `logs`
   - Используйте команду `sc query DualAIBot`

## Решение проблем

### Бот не запускается

1. **Проверьте установку Python**:
   ```batch
   python --version
   ```

2. **Проверьте доступность Telegram API**:
   ```batch
   ping api.telegram.org
   ```

3. **Проверьте правильность токена**:
   - Убедитесь, что токен указан верно в файле `.env`
   - Попробуйте пересоздать файл `.env` с правильным токеном

4. **Проверьте логи**:
   - Изучите файлы в папке `logs` на предмет ошибок

### Служба запускается и сразу останавливается

1. **Проверьте конфигурацию службы**:
   ```batch
   nssm edit DualAIBot
   ```

2. **Проверьте ошибки в логах службы**:
   - Изучите файлы `logs\service_stderr.log`

3. **Попробуйте запустить вручную**:
   - Запустите `setup_and_run_bot.bat` для определения проблемы

## Дополнительная информация

### Автозапуск после перезагрузки

Если бот установлен как служба, он будет автоматически запускаться при старте системы.

### Обновление бота

1. **Получите последние изменения**:
   ```batch
   cd DualAI
   git pull
   ```

2. **Перезапустите бота**:
   - Если запущен вручную - остановите (`Ctrl+C`) и запустите заново
   - Если работает как служба - `sc stop DualAIBot && sc start DualAIBot` 