# DUALAI_DEVELOPMENT.md

## Общее описание проекта

DualAI — это инновационная платформа для бизнес-коммуникаций, построенная на базе Telegram бота с двухрежимным искусственным интеллектом. Система позволяет работать в двух режимах: административном (для управления бизнес-процессами) и клиентском (для взаимодействия с потенциальными покупателями). Основной фокус начальной версии — рынок недвижимости, с возможностью адаптации под другие отрасли в будущем. Платформа использует OpenAI API для обеспечения естественного общения и персонализированных рекомендаций, а также интегрируется с Telegram Mini Apps для улучшения пользовательского опыта.

## Вопросы для конкретизации на следующих этапах

1. **Функциональные возможности режимов**
   - Какие конкретные действия должен выполнять администратор? (добавление/удаление объектов, просмотр статистики)
   - Какие операции доступны в клиентском режиме? (поиск по параметрам, запись на просмотр)
   - Как происходит переключение между режимами?

2. **Интеграция с OpenAI**
   - Какую конкретно модель планируется использовать? (GPT-3.5-turbo, GPT-4)
   - Как структурировать промпты для разных режимов?
   - Как эффективно управлять контекстом для длительных диалогов?

3. **Детали реализации базы данных**
   - Какие конкретные поля необходимы в таблице недвижимости?
   - Как реализовать хранение истории взаимодействий с клиентами?
   - Нужны ли дополнительные таблицы для аналитики?

4. **Telegram Mini App**
   - На каком этапе планируется интеграция с мини-приложением?
   - Какие компоненты должны быть реализованы в первой версии?
   - Как реализовать обмен данными между ботом и мини-приложением?

5. **Масштабирование и развитие**
   - Каковы технические ограничения текущей архитектуры?
   - Какие критерии определяют необходимость перехода с SQLite на PostgreSQL?
   - Какие метрики будут использоваться для оценки эффективности системы?

## Текущие задачи (Фаза 1: Базовая инфраструктура)

1. **Настройка структуры проекта** [✅]
   - Создать основные директории (data, handlers) [✅]
   - Настроить .gitignore для исключения конфиденциальных данных [✅]
   - Настроить виртуальное окружение и requirements.txt [✅]

2. **Разработка схемы базы данных SQLite** [⏳]
   - Спроектировать таблицы для пользователей (admin/client) [⏳]
   - Создать схему для объектов недвижимости [⏳]
   - Реализовать функции CRUD в database.py [⏳]

3. **Интеграция с OpenAI API** [⏳]
   - Настроить подключение с использованием API ключа [⏳]
   - Разработать базовые промпты для обоих режимов [⏳]
   - Создать механизм управления контекстом запросов [⏳]

4. **Базовая структура Telegram бота** [✅]
   - Настроить обработчики команд (/start, /help, /admin) [✅]
   - Реализовать механизм определения типа пользователя [✅]
   - Создать базовый маршрутизатор сообщений [✅]

5. **Реализация административного функционала** [⏳]
   - Разработать систему аутентификации администратора [⏳]
   - Создать интерфейс управления объектами недвижимости [⏳]
   - Реализовать базовые операции с объектами (добавление, просмотр, редактирование, удаление) [⏳]
   - Добавить возможность просмотра и ответа на запросы клиентов [⏳]

## Технические требования

- Windows Server для хостинга
- Python 3.13.2
- SQLite для локального хранения данных
- Асинхронные обработчики с python-telegram-bot 22.0
- Интеграция с OpenAI API (GPT-3.5 или GPT-4)
- Модульная архитектура с разделением бизнес-логики

## Архитектура проекта

- **bot.py**: Основной файл с настройкой и запуском бота
- **database.py**: Управление базой данных и CRUD операции
- **openai_connector.py**: Интеграция с OpenAI API
- **handlers/**: Обработчики сообщений и команд
  - **__init__.py**: Инициализация модуля
  - **admin.py**: Логика административного режима
  - **client.py**: Логика клиентского режима

## Детализация административного функционала (MVP)

1. **Аутентификация администратора**
   - Команда `/admin` с проверкой пароля или Telegram ID
   - Переключение в административный режим с отдельным меню
   - Выход из административного режима

2. **Управление объектами недвижимости**
   - Добавление нового объекта через диалоговый интерфейс
     - Основные параметры: тип, площадь, количество комнат, адрес, цена
     - Дополнительная информация: описание, особенности, фотографии
   - Просмотр списка объектов с базовой информацией
   - Просмотр детальной информации о конкретном объекте
   - Редактирование существующих объектов
   - Управление статусом объекта (активен/неактивен/продан)
   - Удаление объекта с подтверждением

3. **Работа с клиентами**
   - Просмотр списка входящих запросов
   - Возможность ответа на запросы через бота
   - Отметка статуса обработки запроса
   - Получение уведомлений о новых запросах

4. **Базовое управление контентом**
   - Публикация информации о новых объектах в канал
   - Обновление FAQ
   - Добавление новостей

## GitHub организация

- **Issues:**
  - #1: Настройка структуры проекта и системы контроля версий [Завершено]
  - #2: Разработка схемы базы данных и CRUD функций [В процессе]
  - #3: Интеграция с OpenAI API [Запланировано]
  - #4: Реализация базовой структуры Telegram бота [Завершено]
  - #5: Разработка административного функционала [Запланировано]

- **Projects:**
  - Канбан: "DualAI Development"
    - To Do
    - In Progress
    - Done

## Соглашения о коммитах

- Формат: `[тип]: краткое описание`
- Типы: feat, fix, docs, style, refactor
- Примеры:
  - `[feat]: add initial database schema`
  - `[fix]: correct OpenAI API connection issues`
  - `[docs]: update project documentation`

## План административных промптов для OpenAI

1. **Системный промпт для admin-режима**
   - Определение контекста работы с недвижимостью
   - Информация о доступных административных операциях
   - Правила формирования ответов и рекомендаций

2. **Промпт для генерации описаний объектов**
   - Структура описания (заголовок, основное описание, преимущества)
   - Стиль и тон (профессиональный, но привлекательный для клиентов)
   - Параметры, которые должны быть подчеркнуты

3. **Промпт для многоязычного контента**
   - Правила перевода специфических терминов недвижимости
   - Сохранение маркетинговой привлекательности при переводе
   - Адаптация под культурные особенности разных стран